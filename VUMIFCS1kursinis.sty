%% VUMIFCS1kursinis.sty
%% Created by  Laurynas Biveinis, Albertas Gimbutas  2014
%
%% Latest version available here: https://github.com/LIKS/course_work_template_mifcs1
%% Any suggestions or contributions are welcome!  Also see: http://latex.liks.lt!
%
%%  License CC BY 4.0 (see more at http://creativecommons.org/licenses/by/4.0/) 
% You are free to (a) share - copy and redistribute the material in any medium
% or format (b) adapt - remix, transform, and build upon the material for any
% purpose, even commercially. As long as you give appropriate credit, provide a
% link to the license, and indicate if changes were made.)


% Kursinio darbo apiforminimas pagal Vilniaus universiteto
% Matematikos ir informatikos fakulteto Informatikos katedros reikalavimus
\ProvidesPackage{VUMIFCS1kursinis}[2015/01/01 1.0 VU MIF CS1 course Style]

\RequirePackage[T1]{fontenc}
\RequirePackage{setspace}
\setstretch{1.4}
\sloppy  % Tolygiai paskirsto tekstą nuo kairės iki dešinės paraštės'

% Titulinio puslapio pagrindinių eleemntų išdėstymas
\DeclareOption{sedepttitle}{%
  \def\@outputtitle{%
  \begin{center}
  \null\vfil
  \@ifundefined{@titleineng}{
      \vskip 2.9cm
      {\@vumifpaper \par}%
      {\singlespacing \Large \textbf{\@title} \par}
  }{
      \vskip 2.4cm
      {\@vumifpaper \par}%
      {\singlespacing \Large \textbf{\@title} \par}
    {\singlespacing \large \textbf{\@titleineng} \par}%
  }
  \end{center}
  \@ifundefined{@secondauthor}{
     \vskip 4.9cm
     \begin{flushright}
        \singlespacing
        {\begin{tabular}[t]{l l}%
          & \medskip \hskip 1cm Atliko: \@status \\
          & \medskip\bigskip \hskip 1cm \@author \hfill \@signatureplace \\
          & \medskip Darbo vadovas: \\
          & \hskip 1cm \@supervisor \hfill  \@signatureplace
        \end{tabular} \par}%
     \end{flushright}
     \@ifundefined{@titleineng}{\vskip 5cm}{\vskip 4cm}
   }{
     \vskip 4.4cm
     \begin{flushright}
        \singlespacing
        {\begin{tabular}[t]{l l}%
          \medskip &\hskip 1cm Atliko: \@status \\
          \medskip\bigskip &\hskip 1cm \@author \hfill \@signatureplace \\
          \medskip\bigskip &\hskip 1cm \@secondauthor \hfill \@signatureplace \\
          & \medskip Darbo vadovas: \\
          & \hskip 1cm \@supervisor \hfill  \@signatureplace
        \end{tabular} \par}%
     \end{flushright}
     \@ifundefined{@titleineng}{\vskip 4cm}{\vskip 3cm}
   }
}}

\ExecuteOptions{sedepttitle}

\ProcessOptions

% Papildoma informacija tituliniame puslapyje
\newcommand{\vumifpaper}[1]{\def\@vumifpaper{#1}}
\newcommand{\vumifdept}[1]{\def\@vumifdept{#1}}
\newcommand{\supervisor}[1]{\def\@supervisor{#1}}
\newcommand{\reviewer}[1]{\def\@reviewer{#1}}
\newcommand{\status}[1]{\def\@status{#1}}
\newcommand{\titleineng}[1]{\def\@titleineng{#1}}
\newcommand{\secondauthor}[1]{\def\@secondauthor{#1}}

% Skyriaus pavadinimas, turinyje neturintis numerio
\newcommand{\sectionnonum}[1]{%
    \section*{#1}%
    \addcontentsline{toc}{section}{#1}% 
}

% Skyriaus pavadinimas, neturintis numerio bei neįeinantis į turinį
% \newcommand{\sectionnonumnocontent}[1]{%
%     \section*{#1}%
% }

% Reikia lietuvybės patobulinimų
\RequirePackage{LTPlius}

% Lapo formato nurodymas, vėliau nurodysime ir paraštes
\RequirePackage{vmargin}
\setmarginsrb{3cm}{2.5cm}{1.5cm}{1.5cm}{0pt}{14pt}{0pt}{5mm}
\setpapersize[portrait]{A4}

% Mums reikės 1,5 intervalo tarp eilučių
\RequirePackage{setspace}

% Keisime standartinius priklausomus nuo kalbos tekstus
\RequirePackage[lithuanian]{babel}
\RequirePackage[titles]{tocloft}
\RequirePackage{etoolbox}

% Pirmos eilutės paragrafe atitraukimas 0,7 cm
\setlength{\parindent}{0.7cm}

% ---------------------------------------------------
% Titulinis puslapis suformatuotas pagal VU MIF formą
% ---------------------------------------------------

\newcommand{\@signatureplace}{%
    \parbox[t]{2.5cm}{%
        \makebox[2.5cm]{\raisebox{-0.5ex}{\scriptsize
        (para\v{s}as) }}}
}

\newcommand{\vumifchecktitle}[2]{%
    % Patikriname, ar visa reikalinga informacija tituliniam puslapiui
    % buvo nurodyta. #1 yra tikrinama reikšmė (be \ priekyje),
    % #2 - klaidos pranešimas.
    \@ifundefined{#1}{\PackageError{VUMIF}{#2}{Add the missing command}}%
}

\renewcommand\maketitle{\begin{titlepage}%
  \vumifchecktitle{@vumifdept}%
    {Tituliniame puslapyje nenurodyta katedra (komanda \protect\vumifdept)}
  \vumifchecktitle{@supervisor}%
    {Tituliniame puslapyje nenurodytas darbo vadovas (komanda \protect\supervisor)}

  \begin{center}
          {\singlespacing VILNIAUS UNIVERSITETAS \\
        MATEMATIKOS IR INFORMATIKOS FAKULTETAS \\
            \MakeUppercase{\@vumifdept}\par }
  \end{center}
  \@outputtitle
  \begin{center}
    {\singlespacing \@date \par}%   
  \end{center}\par
  \@thanks
  \vfil\null
  \end{titlepage}%
  \setcounter{footnote}{0}%
  \global\let\@outputtitle\relax
  \global\let\thanks\relax
  \global\let\maketitle\relax
  \global\let\@papertype\@empty
  \global\let\@thanks\@empty
  \global\let\@author\@empty
  \global\let\@date\@empty
  \global\let\@title\@empty
  \global\let\@vumifdept\@empty
  \global\let\@vumifpaper\@empty
  \global\let\@supervisor\@empty
  \global\let\@reviewer\@empty
  \global\let\title\relax
  \global\let\author\relax
  \global\let\date\relax
  \global\let\and\relax
  \global\let\vumifdept\relax
  \global\let\supervisor\relax
  \global\let\@signatureplace\relax
  \global\let\vumifchecktitle\relax
  % Nustatome dokumentui 1,5 eilutės intervalą
  \onehalfspacing
}


\renewcommand\tableofcontents{%
    \pagestyle{plain}%
    % Turinys su viengubu intervalu tarp eilučių
    \begin{singlespacing}%
        \section*{\rm\normalsize\centering\contentsname
        \@mkboth{%
           \MakeUppercase\contentsname}{\MakeUppercase\contentsname}}%
    \@starttoc{toc}%
    \end{singlespacing}%
    \newpage%
    }

% Tarpai tarp taškų turinyje
\renewcommand{\@dotsep}{1}

% Pakeitimai sekcijos eilutėms turinyje:
% 1. Turinyje turi taškai bėgti ir iki sekcijų
% 2. Nėra vertikalaus tarpo prieš sekcijos turinio eilutę
% 3. Ne pusstoris, o paprastas šriftas
\renewcommand\l@section[2]{%
  \ifnum \c@tocdepth >\z@
    \addpenalty\@secpenalty
    \addvspace{0em \@plus\p@}
    \setlength\@tempdima{1.5em}%
    \begingroup
      \parindent \z@ \rightskip \@pnumwidth
      \parfillskip -\@pnumwidth
      \leavevmode {
      \advance\leftskip\@tempdima
      \hskip -\leftskip
      #1}\nobreak\
      \leaders\hbox{$\m@th\mkern \@dotsep mu\hbox{.}\mkern \@dotsep mu$}
     \hfil \nobreak\hb@xt@\@pnumwidth{\hss #2}\par
    \endgroup
  \fi}


% Sekcija pradeda naują puslapį
\renewcommand{\section}{%
    \cleardoublepage%
    \@startsection {section}{1}{\z@}%
        {-3.5ex \@plus -1ex \@minus -.2ex}%
        {0.1ex \@plus.2ex}%
        {\normalfont\Large\bfseries}%
}

% Puslapiai numeruojami apačioje
\def\ps@plain{%
    \renewcommand{\@oddhead}{\hfill\textrm{\thepage}}%
    \renewcommand{\@evenhead}{\@oddhead}%
    \renewcommand{\@evenfoot}{}%
    \renewcommand{\@oddfoot}{}%
}


% Priedo sekcijų formatavimas turiniui
\renewcommand{\appendix}{%
    \renewcommand{\section}{%
        \cleardoublepage%
         \secdef\@Appendix\@sAppendix%
     }%
    \makeatletter
    \addtocontents{toc}{\def\string\@dotsep{1000}}
    % \addtocontents{toc}{\protect\thispagestyle{empty}}   % Removes page number from ToC
    \makeatother
    \setcounter{section}{0}%
    \renewcommand{\thesection}{Nr. \arabic{section}}%
}

\def\@Appendix[#1]#2{%
    \refstepcounter{section}%
    \cftaddtitleline{toc}{section}{Priedas Nr.\arabic{section}}{}
    {\large\bfseries\appendixname\ \thesection\par
     #2\par}%
    \sectionmark{#1}\vspace{\baselineskip}%
    \footnotesize
}

\def\@sAppendix#1{%
    {\flushright\large\bfseries\appendixname\par
     \centering#1\par}% \nohyphens\centering#1\par}%
    \vspace{\baselineskip}%
    \footnotesize
}

% Literatūros sąrašą reikia pervadinti
\addto\captionslithuanian{%
    \renewcommand{\refname}{Literat\={u}ros s\k{a}ra\v{s}as}%
}

% Literatūros sąrašą įtraukiame į turinį, nustatome jo stilių
\let\oldbibliography\bibliography
\renewcommand{\bibliography}[1]{%
    \cleardoublepage%
    \addcontentsline{toc}{section}{\refname}%}
    \bibliographystyle{alpha}%
    \oldbibliography{#1}%
}

% Apibrėžiame ketvirto lygio skyrius
\newcommand{\subsubsubsection}{\subsubparagraph}

\makeatletter
\renewcommand\subsubsubsection{\@startsection{paragraph}{4}{0ex}{-3.25ex plus -1ex minus
-0.2ex}{1.5ex plus 0.2ex}{\normalfont\normalsize\bfseries}}
\makeatother

\stepcounter{secnumdepth}
\stepcounter{tocdepth}
\renewcommand{\paragraph}{\subparagraph}

% Turinio skyrių indentavimo nustatymas. Kiekvienam skyriui nustatoma:
% 1. Atitraukimo iš kairės plotis
% 2. Vietos, skiriama skaičiams, plotis
\makeatletter
  \renewcommand*\l@subsection{\@dottedtocline{2}{0.1cm}{0.87cm}}
  \renewcommand*\l@subsubsection{\@dottedtocline{3}{0.8cm}{1.22cm}}
  \renewcommand*\l@paragraph{\@dottedtocline{4}{1.5cm}{1.52cm}}
\makeatother
